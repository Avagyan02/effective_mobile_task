
# Monitor Test Script

Этот скрипт предназначен для мониторинга процесса `test` в Linux-среде. Скрипт выполняет проверку состояния процесса и периодически отправляет информацию на сервер мониторинга. В случае перезапуска процесса или недоступности сервера, информация записывается в лог.

## Функциональность

1. **Мониторинг процесса `test`**: Скрипт проверяет, запущен ли процесс с именем `test`. Если процесс не запущен, скрипт ничего не делает.
2. **Отправка данных на сервер мониторинга**: Если процесс запущен, скрипт отправляет запрос на сервер мониторинга по адресу `https://test.com/monitoring/test/api`.
3. **Логирование**: Если процесс был перезапущен или сервер мониторинга недоступен, скрипт записывает соответствующие сообщения в лог-файл `/var/log/monitoring.log`.
4. **Запуск каждую минуту**: Скрипт может быть настроен на автоматический запуск каждую минуту через cron или systemd.

## Установка

1. **Клонирование репозитория (если нужно)**:
   ```bash
   git clone https://your-repository-url.git
   cd your-repository-folder
   ```

2. **Скачайте или создайте файл `monitor_test.sh`**:
   Скопируйте содержимое скрипта в файл `monitor_test.sh`:
   ```bash
   nano monitor_test.sh
   ```

3. **Сделайте скрипт исполняемым**:
   ```bash
   chmod +x monitor_test.sh
   ```

4. **Создайте лог-файл** (если он еще не существует):
   ```bash
   sudo touch /var/log/monitoring.log
   sudo chmod 644 /var/log/monitoring.log
   ```

## Настройка

1. **Добавление скрипта в cron для запуска каждую минуту**:
   Откройте cron для редактирования:
   ```bash
   crontab -e
   ```
   Добавьте строку для выполнения скрипта каждую минуту:
   ```bash
   * * * * * /полный/путь/к/monitor_test.sh
   ```

2. **Проверка работы скрипта**:
   Чтобы проверить работу скрипта вручную, выполните:
   ```bash
   ./monitor_test.sh
   ```

   После этого проверьте лог-файл:
   ```bash
   cat /var/log/monitoring.log
   ```

3. **Параметры**:
   - `PROCESS_NAME`: имя процесса для мониторинга (по умолчанию `test`).
   - `MONITORING_URL`: URL для отправки запросов на сервер мониторинга (по умолчанию `https://test.com/monitoring/test/api`).
   - `LOG_FILE`: путь к лог-файлу (по умолчанию `/var/log/monitoring.log`).
   - `PREVIOUS_STATUS_FILE`: файл для хранения состояния последнего запуска процесса (по умолчанию `/tmp/monitor_test_status`).

## Логирование

Лог-файл `/var/log/monitoring.log` будет содержать записи о следующих событиях:

- **Перезапуск процесса**:
  ```
  [2024-12-07 14:00:00] - Процесс test был перезапущен
  ```

- **Доступность сервера мониторинга**:
  ```
  [2024-12-07 14:00:00] - Сервер мониторинга доступен
  ```
  или
  ```
  [2024-12-07 14:00:00] - Сервер мониторинга недоступен
  ```

- **Не найден процесс**:
  ```
  [2024-12-07 14:00:00] - Процесс test не запущен
  ```

## Примечания

- Убедитесь, что у вас есть права для записи в лог-файл `/var/log/monitoring.log`.
- Этот скрипт можно адаптировать для других процессов, изменив переменную `PROCESS_NAME`.
- URL для мониторинга можно заменить на свой собственный.

## Лицензия

Этот проект лицензирован под [MIT License](LICENSE).
